<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修JAVA合并word文档生成目录' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>JAVA合并word文档生成目录</center></div><div class='banquan'>原文出处:本文由博客园博主流逝、提供。<br/>
原文连接:https://www.cnblogs.com/hunmeng/p/11983701.html</div><br>
    <p><span style="font-size: 14pt;">下载jar包，或者引入相关maven</span></p>
<p><span style="font-size: 14pt;">maven引入相关地址：<a href="https://www.e-iceblue.cn/licensing/install-spirepdf-for-java-from-maven-repository.html" target="_blank">https://www.e-iceblue.cn/licensing/install-spirepdf-for-java-from-maven-repository.html</a></span></p>
<p><span style="font-size: 14pt;">jar包下载地址：<a href="https://www.e-iceblue.cn/send/46-free-spire-doc-for-java/374-spire-doc-java-free-2-7-3.html" target="_blank">点击下载</a></span></p>
<p>&nbsp;</p>
<p><span style="font-size: 14pt;">如果不知道怎么引入jar包到项目中，请面向百度。</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 14pt;">如果word文档中已经设置了<span style="color: #ff0000;">大纲</span>就直接使用一段代码即可</span></p>
<p>&nbsp;</p>
<src class="cnblogs_code">
<pre><code>    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[]args){
        </span><span style="color: #008000;">//</span><span style="color: #008000;">加载测试文档</span>
        Document doc = <span style="color: #0000ff;">new</span> Document("测试文件.docx"<span style="color: #000000;">);

        </span><span style="color: #008000;">//</span><span style="color: #008000;">在文档最前面插入一个段落，写入文本并格式化</span>
        Paragraph parainserted = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Paragraph(doc);
        TextRange tr</span>= parainserted.appendText("目 录"<span style="color: #000000;">);
        tr.getCharacterFormat().setBold(</span><span style="color: #0000ff;">true</span><span style="color: #000000;">);
        tr.getCharacterFormat().setTextColor(Color.gray);
        doc.getSections().get(</span>0).getParagraphs().insert(0<span style="color: #000000;">,parainserted);
        parainserted.getFormat().setHorizontalAlignment(HorizontalAlignment.Center);
        
        </span><span style="color: #008000;">//</span><span style="color: #008000;">手动设置文档中指定段落的大纲级别</span>
        doc.getSections().get(0).getParagraphs().get(1<span style="color: #000000;">).applyStyle(BuiltinStyle.Heading_1);
        doc.getSections().get(</span>0).getParagraphs().get(2<span style="color: #000000;">).applyStyle(BuiltinStyle.Heading_2);
        doc.getSections().get(</span>0).getParagraphs().get(4<span style="color: #000000;">).applyStyle(BuiltinStyle.Heading_2);
        doc.getSections().get(</span>0).getParagraphs().get(6<span style="color: #000000;">).applyStyle(BuiltinStyle.Heading_2);
        doc.getSections().get(</span>0).getParagraphs().get(12<span style="color: #000000;">).applyStyle(BuiltinStyle.Heading_2);
        doc.getSections().get(</span>0).getParagraphs().get(13<span style="color: #000000;">).applyStyle(BuiltinStyle.Heading_3);
        doc.getSections().get(</span>0).getParagraphs().get(14<span style="color: #000000;">).applyStyle(BuiltinStyle.Heading_3);
        doc.getSections().get(</span>0).getParagraphs().get(15<span style="color: #000000;">).applyStyle(BuiltinStyle.Heading_3);
        doc.getSections().get(</span>0).getParagraphs().get(17<span style="color: #000000;">).applyStyle(BuiltinStyle.Heading_1);
        doc.getSections().get(</span>0).getParagraphs().get(18<span style="color: #000000;">).applyStyle(BuiltinStyle.Heading_2);

        </span><span style="color: #008000;">//</span><span style="color: #008000;">添加目录</span>
        doc.getSections().get(0).getParagraphs().get(0).appendTOC(1,3<span style="color: #000000;">);

        </span><span style="color: #008000;">//</span><span style="color: #008000;">更新目录表</span>
<span style="color: #000000;">        doc.updateTableOfContents();

        </span><span style="color: #008000;">//</span><span style="color: #008000;">保存文档</span>
        doc.saveToFile("目录.docx"<span style="color: #000000;">,FileFormat.Docx_2010);
    }</span></code></pre>

<p>demo来源地址：https://www.e-iceblue.cn/spiredocforjavaformfield/add-word-toc-in-java.html</p>
<p>&nbsp;</p>
<p>下面这个是没有设置大纲的文档生成目录，我的方案是把每页第一段设置为大纲，然后生成目录。</p>
<p>下面的是<span style="color: #ff0000;">合并文档</span>然后生成目录和页码的代码逻辑。</p>
<p>&nbsp;</p>
<src class="cnblogs_code">
<pre><code>    <span style="color: #008000;">/**</span><span style="color: #008000;">
    *    先临时生成一个合并完成后的docx格式文档，doc会出现乱码。
    * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> pathList 所有需要合并的文档的绝对路径
    * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> savePath 一个路径，但是没有文件的后缀，之后进行拼接。
    * </span><span style="color: #808080;">@return</span><span style="color: #008000;"> 状态，是否保存成功
    </span><span style="color: #008000;">*/</span>
   <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">boolean</span> mergeWordToPdf(List&lt;String&gt;<span style="color: #000000;"> pathList, String savePath){
       </span><span style="color: #008000;">//</span><span style="color: #008000;">判断是否为pdf文件后缀的路径
</span><span style="color: #008000;">//</span><span style="color: #008000;">       String[] split = savePath.split("\\.");
</span><span style="color: #008000;">//</span><span style="color: #008000;">       if (!"pdf".equals(split[split.length-1])) {
</span><span style="color: #008000;">//</span><span style="color: #008000;">           System.out.println("请给一个以pdf保存路径结尾的路径");
</span><span style="color: #008000;">//</span><span style="color: #008000;">           return false;
</span><span style="color: #008000;">//</span><span style="color: #008000;">       }
       </span><span style="color: #008000;">//</span><span style="color: #008000;">保存合并完成后临时存放的文件</span>
       String file =  savePath + ".docx"<span style="color: #000000;">;
       File newfile </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> File(file);
       </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {
           </span><span style="color: #008000;">//</span><span style="color: #008000;">判断是否存在，存在则删除</span>
           <span style="color: #0000ff;">if</span><span style="color: #000000;"> (newfile.exists()) {
               newfile.delete();
           }
           newfile.createNewFile();
           </span><span style="color: #008000;">//</span><span style="color: #008000;">创建一个新的doc文件</span>
           Document doc = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Document(file);
           </span><span style="color: #0000ff;">int</span> count = 0<span style="color: #000000;">;
           </span><span style="color: #008000;">//</span><span style="color: #008000;"> 进行合并</span>
           <span style="color: #0000ff;">for</span><span style="color: #000000;"> (String filePath : pathList) {
               </span><span style="color: #008000;">//</span><span style="color: #008000;"> 获取文档的路径,然后合并</span>
               count++<span style="color: #000000;">;
               Document doc2 </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Document();
               doc2.loadFromFile(filePath);
               </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> j = 0; j &lt; doc2.getSections().getCount(); j++<span style="color: #000000;">) {
                   doc.getSections().add(doc2.getSections().get(j).deepClone());
               }
           }

           </span><span style="color: #008000;">//</span><span style="color: #008000;"> 在开头创建一个目录页</span>
           ParagraphStyle title1style = <span style="color: #0000ff;">new</span><span style="color: #000000;"> ParagraphStyle(doc);
           title1style.setName(</span>"TL1"<span style="color: #000000;">);
           title1style.getParagraphFormat().setOutlineLevel(OutlineLevel.Level_1);
           doc.getStyles().add(title1style);
           Section sec </span>= doc.getSections().get(0<span style="color: #000000;">);
           </span><span style="color: #008000;">//</span><span style="color: #008000;">设置边距</span>
           sec.getPageSetup().getMargins().setTop(71.882f<span style="color: #000000;">);
           sec.getPageSetup().getMargins().setBottom(</span>71.882f<span style="color: #000000;">);
           sec.getPageSetup().getMargins().setLeft(90f);
           sec.getPageSetup().getMargins().setRight(90f);
           sec.getParagraphs().get(</span>0<span style="color: #000000;">).applyStyle(title1style.getName());

           </span><span style="color: #008000;">//</span><span style="color: #008000;">循环遍历每一页的标题，并添加到目录页中</span>
           <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = 1; i &lt;= count; i++<span style="color: #000000;">) {
               sec </span>=<span style="color: #000000;"> doc.getSections().get(i);
               sec.getParagraphs().get(</span>0<span style="color: #000000;">).applyStyle(title1style.getName());
           }
           sec </span>= doc.getSections().get(0<span style="color: #000000;">);
           Paragraph para </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Paragraph(doc);
           sec.getParagraphs().insert(</span>0<span style="color: #000000;">, para);
           TableOfContent toc </span>= para.appendTOC(1, 3<span style="color: #000000;">);
           toc.setUseHeadingStyles(</span><span style="color: #0000ff;">false</span><span style="color: #000000;">);
           toc.setUseHyperlinks(</span><span style="color: #0000ff;">true</span><span style="color: #000000;">);
           toc.setUseTableEntryFields(</span><span style="color: #0000ff;">false</span><span style="color: #000000;">);
           toc.setRightAlignPageNumbers(</span><span style="color: #0000ff;">true</span><span style="color: #000000;">);
           toc.setTOCLevelStyle(</span>1<span style="color: #000000;">, title1style.getName());
           doc.isUpdateFields();
           doc.updateTableOfContents();

           </span><span style="color: #008000;">//</span><span style="color: #008000;">设置目录的字体</span>
           TextRange range = para.appendText("目录"<span style="color: #000000;">);
           range.getCharacterFormat().setFontName(</span>"宋体"<span style="color: #000000;">);
           range.getCharacterFormat().setFontSize(</span>16<span style="color: #000000;">);
           para.getFormat().setHorizontalAlignment(HorizontalAlignment.Center);
           sec.getParagraphs().insert(</span>0<span style="color: #000000;">, para);
           </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = 0; i &lt; sec.getParagraphs().getCount(); i++<span style="color: #000000;">) {
               Paragraph p </span>=<span style="color: #000000;"> sec.getParagraphs().get(i);
               </span><span style="color: #0000ff;">if</span> (p.getStyleName().equals("TOC1"<span style="color: #000000;">)) {
                   </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> j = 0; j &lt; p.getChildObjects().getCount(); j++<span style="color: #000000;">) {
                       </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (p.getChildObjects().get(j).getDocumentObjectType().equals(DocumentObjectType.Text_Range)) {
                           TextRange range0 </span>=<span style="color: #000000;"> (TextRange) p.getChildObjects().get(j);
                           range0.getCharacterFormat().setFontName(</span>"宋体"<span style="color: #000000;">);
                           range0.getCharacterFormat().setBold(</span><span style="color: #0000ff;">false</span><span style="color: #000000;">);
                       }
                   }
               }
           }
           </span><span style="color: #008000;">//</span><span style="color: #008000;">删除页眉</span>
           <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = 1; i &lt;= count; i++<span style="color: #000000;">) {
               ParagraphCollection paragraphsHeader </span>=<span style="color: #000000;"> doc.getSections().get(i).getHeadersFooters().getHeader().getParagraphs();
               </span><span style="color: #0000ff;">if</span> (paragraphsHeader.getCount() &gt; 0<span style="color: #000000;">) {
                   paragraphsHeader.removeAt(</span>0<span style="color: #000000;">);
               }
               doc.getSections().get(i).getHeadersFooters().getFirstPageFooter().getChildObjects().clear();
               doc.getSections().get(i).getHeadersFooters().getOddFooter().getChildObjects().clear();
           }

           </span><span style="color: #008000;">//</span><span style="color: #008000;">添加文字、页码域和总页数域到段落</span>
           Paragraph paragraph = doc.getSections().get(0<span style="color: #000000;">).getHeadersFooters().getFirstPageFooter().addParagraph();
           paragraph.appendField(</span>"page number"<span style="color: #000000;">, FieldType.Field_Page);
           paragraph.getFormat().setHorizontalAlignment(HorizontalAlignment.Right);

           Paragraph paragraph1 </span>= doc.getSections().get(0<span style="color: #000000;">).getHeadersFooters().getOddFooter().addParagraph();
           paragraph1.appendField(</span>"page number"<span style="color: #000000;">, FieldType.Field_Page);
           paragraph1.getFormat().setHorizontalAlignment(HorizontalAlignment.Right);
           
           </span><span style="color: #008000;">//</span><span style="color: #008000;">在转换为pdf时出现字体便乱的情况，格式化字体后解决。如果不需要转换为pdf，此操作可以删除。</span>
           <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> a = 1; a &lt;= count; a++<span style="color: #000000;">) {
               Section s </span>=<span style="color: #000000;"> doc.getSections().get(a);
               </span><span style="color: #008000;">//</span><span style="color: #008000;">更新全文的字体（不包括tbale里的）</span>
               <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = 1; i &lt; s.getParagraphs().getCount(); i++<span style="color: #000000;">) {
                   Paragraph p </span>=<span style="color: #000000;"> s.getParagraphs().get(i);
                   </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> j = 0; j &lt; p.getChildObjects().getCount(); j++<span style="color: #000000;">) {
                       </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (p.getChildObjects().get(j).getDocumentObjectType().equals(DocumentObjectType.Text_Range)) {
                           TextRange range0 </span>=<span style="color: #000000;"> (TextRange) p.getChildObjects().get(j);
                           range0.getCharacterFormat().setFontName(</span>"宋体"<span style="color: #000000;">);
                           range0.getCharacterFormat().setBold(</span><span style="color: #0000ff;">false</span><span style="color: #000000;">);
                       }
                   }
               }
               TableCollection tables </span>=<span style="color: #000000;"> s.getTables();
               </span><span style="color: #008000;">//</span><span style="color: #008000;">更新table里字体</span>
               <span style="color: #0000ff;">if</span> (tables.getCount() &gt; 0<span style="color: #000000;">) {
                   updateTable(tables);
               }
           }

           </span><span style="color: #008000;">//</span><span style="color: #008000;">保存word文件</span>
<span style="color: #000000;">           doc.saveToFile(file, FileFormat.Docx);
           </span><span style="color: #008000;">//</span><span style="color: #008000;">转换为pdf，转换的代码在下一篇文章里，使用的不是同一个jar包，因为这个jar对生成pdf没有限制，准确的说是破*了。</span>
           //WordToPdfUtil.wordToPdf(file, savePath + ".pdf");<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;
       }</span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception e){
           e.printStackTrace();
       }
       </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
   }</span></code></pre>

<p>&nbsp;</p>
<p>可能每个人的需求都不一样，不过你可以去查看相关Api或者官方demo进行修改。</p>
<p>&nbsp;</p>
<p>此产品版本是<span style="color: #ff0000;">免费版</span>的，我也是在用免费，除了只能单次识别25张一下的word和生成pdf有限制，其他的功能都和正式版差不多。</p>
<p>如果你几十个文档，每个文档几页，输出出来超过25页，那没关系，依然可以使用。别单个文档超过<span style="color: #ff0000;">25页</span>即可。</p>
<p>如果公司使用，请支持购买收费版。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>转换pdf的文章路径：</p>
<p><a href="https://www.cnblogs.com/hunmeng/p/11983882.html" target="_blank">https://www.cnblogs.com/hunmeng/p/11983882.html</a></p>

</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>