<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修CentOS7中安装MariaDB' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>CentOS7中安装MariaDB</center></div><div class='banquan'>原文出处:本文由博客园博主IsaacZhang提供。<br/>
原文连接:https://www.cnblogs.com/zhangpan1244/p/11955798.html</div><br>
    <h1 id="安装方式">安装方式</h1>
<ul>
<li>在线安装（慢的要命）</li>
<li>RPM离线安装(CentOS7.X)</li>
</ul>
<h2 id="在线安装">在线安装</h2>
<ol>
<li>打开官方网站 <a href="https://mariadb.org/" class="uri">https://mariadb.org/</a><br />
<img src="./images/CentOS7中安装MariaDB0.png" alt="图1" /><br />
</li>
<li>点击<a href="https://mariadb.org/download/">Download</a>,跳转到下一页面<br />
<img src="./images/CentOS7中安装MariaDB1.png" alt="图2" /><br />
</li>
<li>继续点击<a href="https://downloads.mariadb.org/">Download</a>,进到下页<br />
<img src="./images/CentOS7中安装MariaDB2.png" alt="图3" /><br />
</li>
<li>点击红框中的[链接] (https://downloads.mariadb.org/mariadb/repositories/#mirror=23Media),进到一下页面<br />
<img src="./images/CentOS7中安装MariaDB3.png" alt="图4" /><br />
</li>
<li>根据自己的服务器的类型/版本来选择要安装的数据库版本.<br />
按照上述步骤可以在线安装。</li>
</ol>
<h2 id="离线安装">离线安装</h2>
<ol>
<li>点击图4中的<a href="http://yum.mariadb.org/10.4/centos7-amd64">baseurl</a><br />
<img src="./images/CentOS7中安装MariaDB4.png" alt="图5" /><br />
</li>
<li>点击<a href="http://yum.mariadb.org/10.4/centos7-amd64/rpms/">rpms</a>, 可以看到一堆rpm包，不要着急，继续看下一步<br />
<img src="./images/CentOS7中安装MariaDB5.png" alt="图6" /><br />
</li>
<li><p>打开<a href="mariadb.org">MariaDB org</a> --&gt; <a href="https://mariadb.org/learn/">Learn</a> --&gt; [<a href="https://mariadb.com/kb/en/">MariaDB Knowledge Base</a>] --&gt; <a href="https://mariadb.com/kb/en/documentation/">MariaDB Server</a> --&gt;</p>
<p><a href="https://mariadb.com/kb/en/getting-installing-and-upgrading-mariadb/">Getting, Installing, and Upgrading MariaDB</a> --&gt; <a href="https://mariadb.com/kb/en/library/binary-packages/">MariaDB Binary Packages</a> --&gt; <a href="https://mariadb.com/kb/en/library/rpm/">Installing MariaDB RPM Files</a> --&gt; <a href="https://mariadb.com/kb/en/library/mariadb-installation-version-10121-via-rpms-on-centos-7/">MariaDB Installation (Version 10.1.21) via RPMs on CentOS 7</a></p>
最终的url点击之后，就可以看到如下图所示界面：<br />
<img src="./images/CentOS7中安装MariaDB6.png" alt="图7" /><br />
本来完全可以提供最终的一个url，提供一步一步点击的按钮连接，是为了方便大家来学习路线思路，而不能只拿结果。<br />
</li>
<li><p>还记得我们之前第二步看到的一堆rpm包吗？ 下载第三步方框中的package,当然，这个文档的版本稍有点落后，但是我们只需要搜索前缀名称就行了，比如搜索<code>client</code>:<br />
<img src="./images/CentOS7中安装MariaDB7.png" alt="图8" /><br />
我们下载最新版本就可以了。<br />
接下来进入正式步骤了哦～：<br />
在图7中有<code>Step by step installation</code>:</p></li>
</ol>
<blockquote>
<p>Step by step installation:</p>
<ul>
<li>1) First install all of the dependencies needed. Its easy to do this via YUM packages: yum install rsync nmap lsof perl-DBI nc</li>
<li>2) rpm -ivh jemalloc-3.6.0-1.el7.x86_64.rpm</li>
<li>3) rpm -ivh jemalloc-devel-3.6.0-1.el7.x86_64.rpm</li>
<li>4) rpm -ivh MariaDB-10.1.21-centos7-x86_64-common.rpm MariaDB-10.1.21-centos7-x86_64-compat.rpm MariaDB-10.1.21-centos7-x86_64-client.rpm galera-25.3.19-1.rhel7.el7.centos.x86_64.rpm MariaDB-10.1.21-centos7-x86_64-server.rpm</li>
</ul>
</blockquote>
<p>按照步骤我们开始：</p>
<ol>
<li><p>安装依赖信息，命令行执行：</p>
<pre><code><code>[root@iZ2ze7s2v0b78922wia32rZ software]#  yum install rsync nmap lsof perl-DBI nc</code></code></pre></li>
<li><p>安装我们之前下载的版本<code>jemalloc-3.6.0-1.el7.x86_64.rpm</code></p>
<pre><code><code>[root@iZ2ze7s2v0b78922wia32rZ mariadb]# rpm -ivh jemalloc-3.6.0-1.el7.x86_64.rpm </code></code></pre></li>
<li><p>安装<code>jemalloc-devel-3.6.0-1.el7.x86_64.rpm</code></p>
<pre><code><code>[root@iZ2ze7s2v0b78922wia32rZ mariadb]# rpm -ivh jemalloc-devel-3.6.0-1.el7.x86_64.rpm</code></code></pre></li>
<li><p>安装剩余的mariadb相关的包，一定要注意顺序.<code>common &gt; compat &gt; client &gt; galera &gt; server</code></p>
<pre><code><code>[root@iZ2ze7s2v0b78922wia32rZ mariadb]# rpm -ivh MariaDB-common-10.4.8-1.el7.centos.x86_64.rpm MariaDB-compat-10.4.8-1.el7.centos.x86_64.rpm MariaDB-client-10.4.8-1.el7.centos.x86_64.rpm galera-4-26.4.3-1.rhel7.el7.centos.x86_64.rpm MariaDB-server-10.4.8-1.el7.centos.x86_64.rpm 
warning: MariaDB-common-10.4.8-1.el7.centos.x86_64.rpm: Header V4 DSA/SHA1 Signature, key ID 1bb943db: NOKEY
error: Failed dependencies:
        mariadb-libs &lt; 1:10.1.0 conflicts with MariaDB-compat-10.4.8-1.el7.centos.x86_64
        mariadb-libs is obsoleted by MariaDB-compat-10.4.8-1.el7.centos.x86_64
        libaio.so.1()(64bit) is needed by MariaDB-client-10.4.8-1.el7.centos.x86_64
        libaio.so.1(LIBAIO_0.1)(64bit) is needed by MariaDB-client-10.4.8-1.el7.centos.x86_64
        libaio.so.1(LIBAIO_0.4)(64bit) is needed by MariaDB-client-10.4.8-1.el7.centos.x86_64
        libboost_program_options.so.1.53.0()(64bit) is needed by galera-4-26.4.3-1.rhel7.el7.centos.x86_64
        libaio.so.1()(64bit) is needed by MariaDB-server-10.4.8-1.el7.centos.x86_64
        libaio.so.1(LIBAIO_0.1)(64bit) is needed by MariaDB-server-10.4.8-1.el7.centos.x86_64
        libaio.so.1(LIBAIO_0.4)(64bit) is needed by MariaDB-server-10.4.8-1.el7.centos.x86_64</code></code></pre>
<p>执行之后发现报错，还是在图7显示页面，我们可以看见<code>Step by step installation:</code> 段落结束之后有这么一句： <code>Here is the error message for dependencies:</code></p>
<blockquote>
<pre><code><code># rpm -ivh MariaDB-10.1.21-centos7-x86_64-common.rpm 
warning: MariaDB-10.1.21-centos7-x86_64-common.rpm: Header V4 DSA/SHA1 Signature, key ID 1bb943db: NOKEY
error: Failed dependencies:
   mariadb-libs &lt; 1:10.1.21-1.el7.centos conflicts with MariaDB-common-10.1.21-1.el7.centos.x86_64</code></code></pre>
</blockquote>
<p>是不是和我们的错误很相似？按照官方提供的solution就可以解决了。</p>
<p>后续还有几个错误，同样按照官方给出的解决方案处理，一步一步就搞定了，如下：</p>
<pre><code><code>[root@iZ2ze7s2v0b78922wia32rZ mariadb]# rpm -qa | grep mariadb-libs
mariadb-libs-5.5.60-1.el7_5.x86_64
[root@iZ2ze7s2v0b78922wia32rZ mariadb]# rpm -ev --nodeps mariadb-libs-5.5.60-1.el7_5.x86_64
Preparing packages...
mariadb-libs-1:5.5.60-1.el7_5.x86_64
[root@iZ2ze7s2v0b78922wia32rZ mariadb]# rpm -qa | grep mariadb-libs                        
[root@iZ2ze7s2v0b78922wia32rZ mariadb]# yum install boost-devel.x86_64
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
Resolving Dependencies
--&gt; Running transaction check
...
Is this ok [y/d/N]: y
...

Complete!
[root@iZ2ze7s2v0b78922wia32rZ mariadb]# rpm --import http://yum.mariadb.org/RPM-GPG-KEY-MariaDB</code></code></pre>
<p>然后重新回到安装的第四步：</p>
<pre><code><code>[root@iZ2ze7s2v0b78922wia32rZ mariadb]# rpm -ivh MariaDB-common-10.4.8-1.el7.centos.x86_64.rpm MariaDB-compat-10.4.8-1.el7.centos.x86_64.rpm MariaDB-client-10.4.8-1.el7.centos.x86_64.rpm galera-4-26.4.3-1.rhel7.el7.centos.x86_64.rpm MariaDB-server-10.4.8-1.el7.centos.x86_64.rpm 
error: Failed dependencies:
        libaio.so.1()(64bit) is needed by MariaDB-client-10.4.8-1.el7.centos.x86_64
        libaio.so.1(LIBAIO_0.1)(64bit) is needed by MariaDB-client-10.4.8-1.el7.centos.x86_64
        libaio.so.1(LIBAIO_0.4)(64bit) is needed by MariaDB-client-10.4.8-1.el7.centos.x86_64
        libaio.so.1()(64bit) is needed by MariaDB-server-10.4.8-1.el7.centos.x86_64
        libaio.so.1(LIBAIO_0.1)(64bit) is needed by MariaDB-server-10.4.8-1.el7.centos.x86_64
        libaio.so.1(LIBAIO_0.4)(64bit) is needed by MariaDB-server-10.4.8-1.el7.centos.x86_64</code></code></pre>
<p>发现还是报错？？？</p>
<p><img src="./images/CentOS7中安装MariaDB8.png" alt="joke1" /></p>
<p>这个是官方在<code>10.4.8</code>中新引入的一个问题,需要下载一个依赖包<code>libaio</code>:</p>
<pre><code><code>[root@iZ2ze7s2v0b78922wia32rZ mariadb]# wget http://mirror.centos.org/centos/6/os/x86_64/Packages/libaio-0.3.107-10.el6.x86_64.rpm
--2019-11-28 10:52:26--  http://mirror.centos.org/centos/6/os/x86_64/Packages/libaio-0.3.107-10.el6.x86_64.rpm</code></code></pre>
<p>下载成功之后，安装一下当前下载的依赖包：</p>
<pre><code><code>[root@iZ2ze7s2v0b78922wia32rZ mariadb]# rpm -ivh libaio-0.3.107-10.el6.x86_64.rpm</code></code></pre></li>
</ol>
<p>然后再一次重复<code>Step 4</code>:</p>
<pre><code><code>[root@iZ2ze7s2v0b78922wia32rZ mariadb]# rpm -ivh MariaDB-common-10.4.8-1.el7.centos.x86_64.rpm MariaDB-compat-10.4.8-1.el7.centos.x86_64.rpm MariaDB-client-10.4.8-1.el7.centos.x86_64.rpm galera-4-26.4.3-1.rhel7.el7.centos.x86_64.rpm MariaDB-server-10.4.8-1.el7.centos.x86_64.rpm 
Preparing...                          ################################# [100%]
Updating / installing...
   1:MariaDB-compat-10.4.8-1.el7.cento################################# [ 20%]
   2:MariaDB-common-10.4.8-1.el7.cento################################# [ 40%]
   3:MariaDB-client-10.4.8-1.el7.cento################################# [ 60%]
   4:galera-4-26.4.3-1.rhel7.el7.cento################################# [ 80%]
   5:MariaDB-server-10.4.8-1.el7.cento################################# [100%]


Two all-privilege accounts were created.
One is root@localhost, it has no password, but you need to
be system &#39;root&#39; user to connect. Use, for example, sudo mysql
The second is mysql@localhost, it has no password either, but
you need to be the system &#39;mysql&#39; user to connect.
After connecting you can set the password, if you would need to be
able to connect as any of these users with a password and without sudo

See the MariaDB Knowledgebase at http://mariadb.com/kb or the
MySQL manual for more instructions.

Please report any problems at http://mariadb.org/jira

The latest information about MariaDB is available at http://mariadb.org/.
You can find additional information about the MySQL part at:
http://dev.mysql.com
Consider joining MariaDB&#39;s strong and vibrant community:
https://mariadb.org/get-involved/</code></code></pre>
<p>终于安装成功了。。。<br />
<img src="./images/CentOS7中安装MariaDB9.png" alt="joke2" /></p>
<p>接下来，最后一步配置数据库：</p>
<pre><code><code># 启动mariaDB,(因为mariaDB是mysql作者写的新的数据库，其实服务和mysql是一样的，所以启动使用的是下面)
[root@iZ2ze7s2v0b78922wia32rZ ~]# service mysql start
# 安全配置
[root@iZ2ze7s2v0b78922wia32rZ ~]# mysql_secure_installation
# 输入root密码，安装后第一次启动为空，直接回车
Enter current password for root (enter for none): 
# step 1： 是否切换到unix_socket安全认证，否
Switch to unix_socket authentication [Y/n] n
# step 2: 更改密码，选择修改
Change the root password? [Y/n] y
# step 3: 移除匿名用户，选择是
Remove anonymous users? [Y/n] y
# step 4: 是否允许root远程登录，根据个人需求，因为我是测试服务器选择允许
Disallow root login remotely? [Y/n] y
# step 5: 移除test数据库
Remove test database and access to it? [Y/n] y
# step 6: 重新加载权限表
Reload privilege tables now? [Y/n] y
# 看到下面，说明成功啦！！！
All done!  If you&#39;ve completed all of the above steps, your MariaDB
installation should now be secure.
Thanks for using MariaDB!</code></code></pre>
<h2 id="测试">测试</h2>
<p>登录数据库：</p>
<pre class="mysql"><code>[root@iZ2ze7s2v0b78922wia32rZ ~]# mysql -u root -p</code></code></pre>
<p>修改root远程连接权限</p>
<pre class="mariadb"><code>MariaDB [(none)]&gt; grant all privileges on *.* to &#39;root&#39;@&#39;%&#39; identified by &#39;your password&#39;;
Query OK, 0 rows affected (0.001 sec)

MariaDB [(none)]&gt; flush privileges;
Query OK, 0 rows affected (0.000 sec)</code></code></pre>
<p>客户端远程连接</p>
<p><img src="./images/CentOS7中安装MariaDB10.png" alt="远程连接成功示意图" /></p>


</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>